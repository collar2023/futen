# 比特币：一种点对点的电子现金系统

**中本聪**  
2008年10月31日

## 摘要

一种完全点对点的电子现金系统，使得在线支付可以直接由一方发起并支付给另一方而无需通过金融机构。数字签名提供了部分解决方案，但如果仍然需要第三方来防止双重支付问题，那么主要的好处就会丧失。我们提出了一种使用工作量证明机制的点对点网络来解决双重支付问题。网络通过将交易打包进不断延展的哈希链中来进行时间戳记录，形成了不可更改的记录，除非对网络大多数节点进行重新计算。只要控制了大多数CPU工作量的节点对最长链进行合作，他们就能表示他们认同链上的交易。网络本身需要最小的结构。消息通过最大努力传播，节点可以随时离开和重新加入网络，接受工作量证明链作为离开期间发生的事件的证明。

## 1. 引言

互联网商业几乎完全依赖于受信任的第三方来处理电子支付。这些系统虽然大部分情况是有效的，但依旧存在固有的弱点。完全不可逆转的交易并不存在，因为金融机构无法完全避免中介机构的参与。中介的存在不仅增加了成本，还限制了小额交易的最低可行尺寸。交易不可逆使得商家必须对欺诈行更有戒心，增加了操作成本。这些成本和不确定性能通过降低支付的终端用户的隐私来避免，一些公司通过匿名方式支付服务费用。然而，隐私问题依旧存在，因为中介机构依然掌握交易双方的信息。

我们提出了一种点对点的电子现金系统，使在线支付可以直接由一方发起并支付给另一方而无需通过金融机构。数字签名提供了部分解决方案，但如果没有防止双重支付的办法，那么系统依旧不完整。我们提出了一种解决方案：通过使用工作量证明机制来创建一个公共的分布式账本，记录所有的交易历史。

## 2. 交易

我们定义一种电子硬币为一串数字签名。每个所有者将硬币传送给下一位所有者时，需要在硬币的哈希值上签名，并在硬币后面附上上一个交易的公钥。收款方可以通过验证签名链来确认交易者的所有权。

然而，问题在于收款方无法验证交易是否被双重支付。一个常规的解决方案是引入受信任的中央权威机构，或者造币厂来检查每一笔交易的双重支付。每一笔交易都要注册在造币厂，只有那些未在双重支付数据库中注册的硬币才会被接受。

为了移除这个信任的第三方，我们需要一个允许双方直接交易的系统，并且确保交易的顺序是不可更改的。我们提出了一种解决方案：通过使用工作量证明机制来创建一个公共的分布式账本，记录所有的交易历史。

## 3. 时间戳服务器

我们提出一个时间戳服务器，通过对时间戳的数据进行哈希处理，并将其广泛公布来工作。每个时间戳包括之前时间戳的哈希，形成一个链，其中每个额外的时间戳加固了之前的时间戳。

## 4. 工作量证明

为了实现点对点的分布式时间戳服务器，我们需要一种工作量证明系统，类似于 Adam Back 的 Hashcash。工作量证明涉及对区块的哈希处理，使得哈希结果满足特定条件。通过不断改变区块中的一些值，找到满足条件的哈希值，这需要大量的计算工作。当满足条件时，网络中的所有节点都能接受该区块的时间戳，并将其添加到区块链中。

## 5. 网络

以下步骤概述了网络的运行过程：

1. 新的交易广播到网络中的所有节点。
2. 每个节点将交易打包进一个区块中。
3. 每个节点都在尝试找到一个让该区块的哈希值满足特定条件的工作量证明。
4. 当一个节点找到一个满足条件的哈希值时，它会将该区块广播到网络中的所有节点。
5. 其他节点通过验证区块中的交易和工作量证明来接受该区块。
6. 节点通过在链上添加该区块并工作下一个区块来表示他们接受该区块。

## 6. 激励机制

通过挖矿生成的新币以及交易费用来激励节点。矿工不仅可以从每个区块的奖励中获取新币，还可以从区块中包含的交易费用中获利。随着新币发行的减少，交易费用将成为矿工的主要激励。

## 7. 磁盘空间

区块头存储哈希值，而不是完整的交易历史，这减少了存储需求。只需要存储区块头信息即可，而交易数据可以存储在节点外部。随着时间的推移，区块头信息的存储需求将保持在合理范围内。

## 8. 简化支付验证

允许轻量级节点通过只下载区块头信息来验证支付，而无需下载完整区块链。简化支付验证提高了网络的可扩展性和便捷性，使更多用户可以轻松参与。

## 9. 结合与分割价值

交易可以将多个输入和输出组合在一起，允许灵活地分割和组合比特币。用户可以通过不同交易的输入和输出组合，实现不同的支付需求。

## 10. 隐私

隐私通过匿名公钥的使用来实现。交易的公钥不会直接关联到用户身份，而是通过生成新的公钥来保护用户隐私。随着时间的推移，公钥的多样性和数量增加，进一步提高了隐私保护水平。

## 11. 计算

网络的安全性依赖于大多数节点控制的计算能力。只要大多数CPU工作量由诚实节点控制，攻击者就无法篡改区块链中的交易记录。攻击者需要控制超过半数的计算能力才能重写区块链，这在实际中几乎是不可能的。

## 12. 结论

我们提出了一种点对点的电子现金系统，消除了对受信任第三方的依赖。通过工作量证明机制，网络节点能够在没有信任基础的情况下达成共识。该系统的安全性和稳定性依赖于大多数节点的诚实工作，确保了交易记录的不可篡改性和网络的去中心化特性。

